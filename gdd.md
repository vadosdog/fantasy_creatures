### **Game Design Document (GDD) — "Рунные Осколки"**

**Версия:** 1.6 (Финальная)

---

## **Оглавление**

1. **Концепция и сеттинг**
    - Мир и лор
    - Роль игрока

2. **Основные механики**
    - Крафт существ
    - Прокачка и эволюция
    - Боевая система
    - Экономика

3. **Контент первой версии**
    - Локации и NPC
    - Существа и осколки
    - Боссы

4. **Технические детали**
    - Платформа и управление
    - Сохранения

5. **Дорожная карта**
    - Будущие обновления

---

## **1. Концепция и сеттинг**

### **1.1 Мир и лор**

В мире, где боги погибли в великой войне, их души рассыпались на магические осколки. Эти осколки:

- Оживают как дикие существа
- Могут быть соединены для создания новых существ
- Хранят обрывки памяти о древних временах

### **1.2 Роль игрока**

Вы — Мастер Осколков, способный:

- Приручать диких существ
- Создавать новых существ через соединение осколков
- Исследовать мир в поисках древних легенд

---

## **2. Основные механики**

### **2.0 Исследование (Процедурные зоны) **

- **Генерация:**  
  - **Биомы:** Уникальные для каждой зоны (лес: болота/чащи; пещеры: залы/тоннели)  
  - **Уровни сложности:** Сила врагов +10% за уровень  
  - **Контент на уровнях:**  
    - Существа, осколки (редкость ↑ с глубиной)  
    - Интерактивные объекты (статуи, деревья с рунами)  
    - Выход на след. уровень (открывается после исследования 80% клеток)
    - На некоторых уровнях спавнятся боссы с уникальными боевыми механиками

- **Правила:**  
  - Перемещение: клик/WASD (без ограничений)  
  - Поражение: телепорт в город + потеря 30% золота и 1 осколка  
  - Завершение: кнопка "Выйти из исследования"  

### **2.1 Крафт существ**

#### **Компоненты:**

- **Комбинации:** 27 вариантов (3 стихии × 3 формы × 3 эмоции)
  | Тип | Варианты (v1.0)       | Влияние на роль |  
  |-----------|-----------------------|-----------------------|  
  | **Стихия**| Огонь, Вода, Трава | Определяет тип урона |  
  | **Форма** | Зверь, Птица, Рептилия| Влияет на размер/вес |  
  | **Эмоция**| Ярость, Азарт, Надежда| Определяет роль:      |  
  | | | - Ярость → Танк |  
  | | | - Азарт → ДД |  
  | | | Надежда → Саппорт |

#### **Процесс:**

1. Выбор 3 осколков (стихия + форма + эмоция).
2. Мини-игра (сложность зависит от комбинации).
3. Получение существа с предопределённой ролью.

### **2.2 Прокачка и эволюция**

- **Уровни:** 1-30
- **Очки умений:**
    - Даются за каждый уровень
    - Тратятся на улучшение характеристик (+1 к атаке/защите/HP за 1 очко)
- **Эволюции:** На 10 и 20 уровнях

### **2.3 Боевая система**

#### **Основные правила**

- **Формат:** Пошаговые сражения 6×6 на гексагональной сетке.
- **Очередность хода:** Зависит от параметра «Инициатива» существ.
- **Дальность атак/способностей:**
    - Ближний бой (1 клетка).
    - Дальний бой (2-3 клетки).

#### **Эффекты (бафы/дебафы)**

| Тип        | Название     | Эффект                                 | Длительность |  
|------------|--------------|----------------------------------------|--------------|  
| **Бафы**   | Усиление     | +10% урона                             | 3 хода       |  
|            | Ускорение    | +2 к дальности перемещения             | 2 хода       |  
|            | Вампиризм    | 30% урона → HP                         | До конца боя |  
| **Дебафы** | Яд           | 5% макс. HP за ход                     | 4 хода       |  
|            | Кровотечение | 8% макс. HP за ход (лечение снимает)   | 3 хода       |  
|            | Безумие      | +30% атаки, -20% защиты, 10% HP за ход | До конца боя |  

#### **Стихийные взаимодействия**

- **Модификаторы урона:**
    - Сильная стихия: ×1.5.
    - Слабая стихия: ×0.75.
    - **Normal-атаки:** ×1 (кроме будущих духов).

#### **Формулы:**

1. **Шанс попадания:**
   ```
   hitChance = max(0.05, min(0.99, 
     skill.hitChance + 
     (attacker.initiativeStat - defender.initiativeStat) / 100 - 
     (attacker.form - defender.form) / 100
   ))
   ```

2. **Шанс крита:**
   ```
   critChance = max(0, 
     skill.critChance + 
     (attacker.willStat - defender.willStat) / 100
   )
   ```

3. **Урон:**
   ```
   damage = floor(
     skill.baseDamage * 
     (attacker.attackStat / defender.defenseStat) * 
     (1 + (attacker.mass - defender.mass) / 100) * 
     elementModifier * 
     (isCrit ? 1.15 : 1)
   )
   ```

4. **Лечение:**  
   *(Аналогично урону, но `baseDamage` → `baseHeal`)*

5. **Наложение эффектов:**
    - На себя: `effect.chance` (без проверок).
    - На врага:
      ```
      effectChance = max(0, 
        effect.chance + 
        (attacker.willStat - defender.willStat) / 100
      )
      ```

---

### **2.4 Экономика**

#### **Ресурсы**

- **Золото:**
    - Получается за бои, квесты, продажу существ.
    - Тратится на артефакты, осколки у NPC.
- **Осколки:**
    - Обычные (выпадают везде).
    - Уникальные (только из сюжета/ивентов).

#### **Магазин NPC**

- **Продажа:** Осколки, артефакты («Зеркало Души»).
- **Покупка:** Существ (только обычных).

---

### **3. Контент первой версии**

### **3.1 Глобальная карта**  
- **Статичный остров с локациями:**  
  - **Город-хаб** (старт)  
  - **Олимп** (финал)  
  - **3-5 сюжетных точек**  
  - **Зоны исследования** (лес, пещеры, вулкан)  

### **3.1 Комбинации осколков**

- **27 вариантов** (3 стихии × 3 формы × 3 эмоции).
- Пример:
    - Огонь + Птица + Азарт → ДД с высокой инициативой.
    - Вода + Рептилия + Надежда → Саппорт с лечением.

### **3.2 Боссы**

- **Механики:**
    - **Лесной страж (Трава):** Накладывает "Яд" на всю команду.
    - **Пламенный дракон (Огонь):** Криты поджигают.
- **Баланс:**
    - При перевесе силы игрока → босс сбегает (минимум наград).
    - При перевесе силы босса → игроку выводится предупреждение "Твои осколки ещё слишком слабы!".

### **4. Существа и осколки**

#### **4.1 Классификация существ**

- **По стихиям:**
    - Огонь, Вода, Земля, Воздух, Свет, Тьма (6 базовых)
    - В будущем: Дух, Металл, Лёд

- **По формам:**
    - Зверь, Гуманоид, Конструкт

- **По эмоциям:**
    - Ярость, Спокойствие, Страх

#### **4.2 Характеристики существ**

#### **Базовые статы:**

| Параметр         | Описание                  | Формула влияния                  |  
|------------------|---------------------------|----------------------------------|  
| `maxHealthStat`  | Макс. здоровье            | -                                |  
| `speedStat`      | Клетки перемещения за ход | -                                |  
| `attackStat`     | Шанс попадания (база)     | Влияет на hitChance              |  
| `defenseStat`    | Шанс защиты               | Уменьшает урон                   |  
| `initiativeStat` | Очередь хода              | Определяет порядок действий      |  
| `willStat`       | Сопротивление эффектам    | Влияет на шанс наложения дебафов |  
| `form`           | Размер (1-10)             | Влияет на шанс попадания         |  
| `mass`           | Вес (1-100)               | Увеличивает урон                 |  
| `element`        | Стихия                    | Определяет модификаторы урона    |  

#### **Роли и акценты:**

| Роль    | Ключевые статы                  |  
|---------|---------------------------------|  
| Танк    | high maxHealthStat, defenseStat |  
| ДД      | high attackStat, mass           |  
| Саппорт | high willStat, initiativeStat   |  

#### **4.3 Примеры существ**

1. **Пламенный ящер (Огонь + Зверь + Ярость):**
    - Высокая атака, поджог при критическом ударе.
2. **Водный страж (Вода + Гуманоид + Спокойствие):**
    - Лечение союзников, сопротивление огню.

#### **4.4 Осколки**

- **Типы:**
    - **Стихии:** Определяют основной тип урона.
    - **Формы:** Влияют на базовые характеристики.
    - **Эмоции:** Дают пассивные эффекты (например, Ярость +5% к криту).

#### **Типы навыков:**

- **Боевые (melee/ranged):** Наносят урон + могут накладывать эффекты.
- **Лечение (treat):** Восстанавливают HP + бафы.

#### **Структура навыка:**

```typescript
{
    name: "Огненный коготь",
        element
:
    "Огонь",
        baseDamage
:
    20,
        hitChance
:
    0.8,
        critChance
:
    0.1,
        actionType
:
    "melee" | "ranged" | "treat",
        range
:
    1, // 0 для treat (на себя)
        effects
:
    [
        {type: "burn", chance: 0.7, target: "target", duration: 2}
    ]
}
```

---

### **5. Технические детали**

#### **5.1 Платформа**

- **Phaser 3** (браузерная 2D RPG).
- **Управление:** Мышь + клавиатура (WASD для перемещения).

#### **5.2 Сохранения**

- Локальные (localStorage) + резерв через экспорт кода.
- **Резерв:** Экспорт/импорт строки кода.

#### **5.3 Требования**

- **Минимальные:**
    - 2 ГБ ОЗУ, браузер с поддержкой WebGL.

---

### **6. Дорожная карта**

#### **Версия 1.0 (Базовый релиз)**

- 5 локаций, 27 комбинаций существ.
- Линейный сюжет, 5 боссов.

#### **Версия 1.5 (Q1 2024)**

- Система талантов.
- 3 новые стихии.

#### **Версия 2.0 (Q3 2024)**

- PvP-арена.
- Кооперативные рейды.

---

### **7. Приложения**

#### **7.1 Глоссарий**

- **Фамильяр:** Существо-спутник (аналог Pokémon GO).
- **Зеркало Души:** Артефакт для сброса очков умений.

#### **7.2 Референсы**

- **Геймплей:** Pokémon + HoMM.
- **Сеттинг:** Dark Souls (атмосфера).

---
