### **Game Design Document (GDD) — "Рунные Осколки"**

**Версия:** 3.0 (Final)

---

## **1. Концепция и сеттинг**

### **1.1. Лор и мир**

**Сеттинг:**  
Мир, где боги погибли, а их сны, мечты и воспоминания материализовались в виде **Рунных Осколков** — кристаллов, хранящих обрывки памяти.
Игрок — **Мастер Осколков**, способный создавать из них существ и пробуждать забытые легенды.

**Ключевые элементы:**

- **Осколки:**
    - Разделены на **стихии** (огонь, вода, трава), **формы** (зверь, птица, рептилия) и **эмоции** (ярость, азарт,
      надежда).
    - Редкость: обычные (белые), редкие (синие), легендарные (золотые).
- **Существа:**
    - Ожившие легенды богов. Каждое имеет **4 эволюции**, завершающиеся пробуждением.
- **Локации:**
    - Статичные зоны (лес, пещеры, вулкан) и **Олимп** — финальная локация, открываемая после пробуждения 6 существ.

**Тон повествования:**  
Мистический, с отсылками к мифам. Пример диалога NPC:  
*"Ты слышишь их шёпот? Осколки зовут тебя... но будь осторожен. Некоторые сны лучше не тревожить."*

### **2. Основные механики**

#### **2.1. Система команд и битв**

##### **Основные правила**

- **Формат:** Пошаговые сражения 6×6 на гексагональной сетке 16х11.
- **Очередность хода:** Зависит от параметра «Инициатива» существ.
- **Дальность хода:** Зависит от характеристики существа speedStat
- **Дальность атак/способностей:**
    - Ближний бой (1 клетка).
    - Дальний бой (до 30 клеток).

##### **Эффекты (бафы/дебафы)**

Все эффекты накладываются на какую-то длительность ходов, в зависимости от конкретного навыка.
Эффекты не стекаются, а увеличивают продолжительность. Нельзя наложить больше 3х бафов и 3 дебафов на существо, при
попытке наложить четвертый ничего не происходит

| Тип        | Название     | Эффект                                      |  
|------------|--------------|---------------------------------------------|
| **Бафы**   | Усиление     | +10% урона                                  |  
|            | Ускорение    | +2 к дальности перемещения                  |  
|            | Удача        | Шанс крита на +15%                          |  
|            | Регенерация  | Увеличивает здоровье каждый ход             |  
|            | Шипы         | Возвращает 20% полученного урона атакующему |  
|            | Щит          | Увеличивает защиту на 10%                   |  
| **Дебафы** | Яд           | 5% макс. HP за ход                          |  
|            | Кровотечение | 8% макс. HP за ход (лечение снимает)        |  
|            | Поджог       | защита -15%, -7%HP каждый ход               |  
|            | Безумие      | +20% атаки, -15% защиты, 10% HP за ход      |
|            | Заморозка    | Уменьшает дальность хода на 1               |
|            | Ослеплен     | Шанс атаки -25%                             |
|            | Проклят      | Проклятие снижает max HP на 10%             |
|            | Страх        | -15% к атаке                                |

##### **Стихийные взаимодействия**

- **Модификаторы урона:**
    - Сильная стихия: ×1.5.
    - Слабая стихия: ×0.75.
    - Нейтральные атаки-атаки: ×1 (кроме будущих духов).

##### **Формулы:**

1. **Шанс попадания:**
   Не может быть ниже 5% и больше 99%, независимо от бафов и дебафов, всегда шанс промаха или попадания
   ```
   hitChance = max(0.05, min(0.99, 
     skill.hitChance
   ))
   ```

2. **Шанс крита:**
   Не может быть больше 25%, независимо от бафов
   ```
   critChance = min(0.25, max(0, 
     skill.critChance + 
     (attacker.willStat - defender.willStat) / 100
   ))
   ```

3. **Урон:**
   Не может быть ниже 30% от базового урона
   ```
   damage = max(
     skill.baseDamage * 0.3,
     floor(
       skill.baseDamage * 
       (attacker.attackStat / defender.defenseStat) * 
       elementModifier * 
       (isCrit ? 1.2 : 1)
     )
   )
   ```

4. **Лечение:**  
   *(Аналогично урону, но `baseDamage` → `baseHeal`)*

5. **Наложение эффектов:**
    - На себя: `effect.chance` (без проверок).
    - На врага:
      ```
      effectChance = max(0, 
        effect.chance + 
        (attacker.willStat - defender.willStat) / 100
      )
      ```

##### **Состав команды:**

- В каждой битве участвует **до 6 существ**, ограничения из уровня битвы:
    - **3-6 существ** должны соответствовать требуемой эволюции для выбранной сложности.
    - **до 2 существ** могут быть на 1 эволюцию ниже (но не более 3х уровней от нужной эволюции)
    - **максимум 1 существо** может быть на 1 эволюцию выше (но не более 3х уровней от эволюции)

##### **Процесс выбора существ:**

1. В PvE:
    - Игрок видит предварительный состав противника.
    - Выбирает 6 существ с учётом ограничений эволюции.
2. В PvP:
    - Поочерёдный драфт: игроки запрещают и выбирают существ (1-1-1-1-1-1).

##### **Локационные эффекты в битве:**

| Локация       | Эффект                                                                          |  
|---------------|---------------------------------------------------------------------------------|  
| Болота        | Замедление (-1 к скорости) для всех, кроме водных существ, игнорируется птицами |  
| Возвышенности | +15% к дальности атак, +10% к точности атак                                     |  
| Вулкан        | Огненные атаки +15%, но водные -15%                                             |  
| Лес           | Шанс 5% наложения "Яда" при начале движения                                     |

_будет дополняться._

**Пример тактики:**  
В локации "Болота" выгодно брать водных существ с высокой скоростью, чтобы игнорировать штрафы.

---

##### Очередность хода существ

Битва разделена на раунды. В начале раунда очередь выстраивается в порядке инициативы существ. На инициативу могут
влиять бафы и дебафы наложенные на существо, поэтому после каждого хода инициатива пересчитывается, поэтому порядок
может измениться. В свой ход существо может

- переместиться на дальность своего хода
- атаковать ближней атакой существо в соседней ячейке
- переместиться и атаковать ближней атакой
- атаковать дальней атакой на расстояние определенное дальностью атаки существа
- наложить баф на себе или союзника на расстояние определенное дальностью бафа
- занять защитную стойку, тогда защита существа увеличится на 10%, а инициатива увеличится на 20% до хода существа в
  следующем раунде (баф defense 2)
- отложить ход, тогда игрок выбирает после кого в этом раунде он хочет походить. Тогда инициатива уменьшится на 20% до
  хода существа в следующем раунде (дебаф Растерянность 3)

#### **2.2. Крафт существ**

**Процесс:**

1. Игрок выбирает **3 осколка** (стихия + форма + эмоция).
2. Нажимает "Создать" → система генерирует существо с:
    - **Базовыми характеристиками** (зависят от редкости осколков).
    - **1-2 стартовыми навыками**.

**Формула качества:**

```  
Бонус к статам = (Кол-во редких осколков × 10%) + (Кол-во легендарных × 25%)  
```  

**Пример:**

- 2 редких + 1 обычный → +20% к максимальным статам.

**Легендарные существа:**

- Требуют **3 легендарных осколка**.
- Имеют уникальные навыки (например, "Феникс" воскресает 1 раз за бой).

---

#### **2.3. Эволюция и пробуждение**

**Этапы прокачки:**  
| Уровни | Эволюция | Изменения |  
|--------|----------|-----------|  
| 1-10 | 1 | Базовая форма |  
| 11-20 | 2 | Новый навык + улучшенная анимация |  
| 21-30 | 3 | Легендарный облик + пассивный эффект |  
| 30+ | 4 (Пробуждение) | Существо покидает команду, давая бонусы |

**После пробуждения:**

- **Перманентный бонус** (например, +5% к атаке всех огненных существ).
- **Легендарный осколок** для крафта.
- **Запись в Библиотеке Легенд** (открывает новые комбинации).

**Артефакт "Цепь Памяти":**

- Блокирует пробуждение.
- Даёт +2 слота для навыков существу.

---

#### **2.4. Слияние существ**

- Объединение **2+ одинаковых существ** усиливает их:
    - +5% к основным статам за каждое.
    - Максимум: +30% (6 существ).
- **Лор-обоснование:** *"Осколки тянутся друг к другу, становясь цельным воспоминанием."*

---

### **3. Прогрессия и баланс**

#### **3.1. Система сложности**

**Уровни сложности:**  
| Уровень | Требования | Особенности | Награды |  
|---------|------------|-------------|---------|  
| Новичок | Эволюция 1 | Противники на 10% слабее | Обычные осколки, базовые ресурсы |  
| Эксперт | Эволюция 2 | Стандартная сила врагов | Редкие осколки, +20% золота |  
| Мастер | Эволюция 3 | Противники на 15% сильнее | Легендарные осколки (10% шанс), артефакты |  
| Легенда | Пробужденные | Уникальные механики боссов | Гарантированный легендарный осколок, титулы |

**Доступ по эволюциям:**

- Для выбора сложности необходимо иметь **3+ существа** требуемой эволюции.
- Пример: для "Мастера" нужны 3 существа 3-й эволюции.

---

#### **3.2. Прокачка существ**

**Получение опыта:**

- За победу в бою:
    - **Обычный бой:** 50-100 XP.
    - **Босс:** 300-500 XP.
- Квесты на прокачку (аренда): +200 XP.

**Кривые роста:**  
| Уровень | Опыт для повышения |  
|---------|--------------------|  
| 1-10 | 500 XP |  
| 11-20 | 1000 XP |  
| 21-30 | 2000 XP |

**Очки умений:**

- Даются за каждый уровень.
- Тратяться на:
    - **Характеристики** (атака, защита и т.д.).
    - **Навыки** (новые способности).

---

#### **3.3. Экономика**

**Ресурсы:**

1. **Золото:**
    - Источники: победы, продажа существ, квесты.
    - Траты: покупка осколков, артефактов.
2. **Осколки:**
    - Дроп:
        - Обычные: 60% (бой), 30% (исследование).
        - Редкие: 30% (бой), 10% (исследование).
        - Легендарные: 10% (только боссы).

**Магазин:**  
| Предмет | Цена (золото) |  
|---------|---------------|  
| Обычный осколок | 100-300 |  
| Редкий осколок | 500-1000 |  
| Артефакт | 2000-5000 |

---

### **4. Контент и локации**

#### **4.1. Основные зоны**

1. **Лес Плачущих Столпов:**
    - Стихия: Трава.
    - Уникальный эффект: "Яд" (-5% HP за ход).
    - Босс: "Лесной Страж" (массовый яд).

2. **Пещеры Голодных Теней:**
    - Стихия: Тьма.
    - Эффект: "Страх" (-15% к атаке).
    - Босс: "Тень Предателя" (крадет HP).

3. **Руины Алхимической Башни:**
    - Стихия: Огонь.
    - Эффект: "Поджог" (-10% HP за ход).
    - Босс: "Пламенный Дракон" (криты поджигают).

4. **Олимп (финал):**
    - Доступ после пробуждения 6 существ.
    - Уникальные бои с "Тенями Богов".
    - Награда: **Артефакты судьбы** (усиливают всех существ).

---

#### **4.2. PvP и события**

- **Арена:**
    - Режимы: 1×1, 3×3, 6×6.
    - Рейтинги и сезонные награды.
- **Легендарные битвы:**
    - Раз в неделю — сражение с усиленным боссом.
    - Требует пробужденных существ.

---

### **5. Технические детали**

#### **5.1. Платформа и управление**

- **Движок:** Phaser 3 (браузерная версия).
- **Управление:**
    - WASD — перемещение.
    - Клики — выбор действий.
- **Сетка боя:** Гексагональная (6×6).

#### **5.2. Сохранения**

- Локальные (LocalStorage) + облачные (опционально).
- Автосохранение после:
    - Боя.
    - Крафта.
    - Пробуждения.

#### **5.3. Оптимизация**

- **Генерация существ:** Предзагруженные шаблоны + рандомизация.
- **Анимации:** Упрощенные эффекты для слабых устройств.

---

### **6. Дорожная карта**

- **Релиз:**
    - 27 существ, 4 локации, PvE.
- **Обновление 1.1:**
    - PvP-арена, 3 новых босса.
- **Обновление 2.0:**
    - Кооперативные рейды, гильдии.
